{% extends "base.html" %}
{% load static %}

{% block content %}
    <title>Ocean Exploration Quiz | Beneath The Blue</title>
    <link rel="stylesheet" href="{% static 'css/quiz.css' %}">   
</head>
<body>
    <video autoplay muted loop id="bg-video" playsinline>
        <source src="{% static 'videos/quiz_video.mp4' %}" type="video/mp4">
        Your browser does not support the video tag.
    </video>
    <div class="video-overlay"></div>

    <div class="content-overlay">
        <main class="quiz-main">
            <div class="quiz-container">
                <div class="quiz-header-section">
                    <h2 class="quiz-heading">
                        Ocean & Marine Exploration Quiz
                    </h2>
                    <div class="quiz-progress">
                        <div class="progress-bar" id="progressBar"></div>
                        <span class="progress-text" id="progressText">0/{{ questions_data|length }} answered</span>
                    </div>
                </div>
                
                <div class="quiz-divider"></div>
                
                <form method="POST" id="quizForm" class="quiz-form">
                    {% csrf_token %}
                    <input type="hidden" name="quiz_id" value="{{ quiz_id }}">
                    
                    <div class="quiz-intro">
                        <p style="color: rgb(0,0,9);">Test your knowledge about our amazing oceans! Complete all {{ questions_data|length }} questions to see your marine expertise score.</p>
                    </div>
                    
                    <div class="quiz-questions">
                        {% for questions in questions_data %}
                        <div class="question-card" id="question-{{ questions.id }}">
                            <div class="question-header">
                                <span class="question-number">Question {{ questions.id }}</span>
                                <span class="question-category">Marine Biology</span>
                            </div>
                            <h3 class="question-text">{{ questions.question }}</h3>
                            
                            <div class="options-grid">
                                <label class="option-card">
                                    <input type="radio" name="question_{{questions.id}}" value="1" required>
                                    <span class="option-letter">A</span>
                                    <span class="option-text">{{ questions.op1 }}</span>
                                    <span class="checkmark"></span>
                                </label>
                                
                                <label class="option-card">
                                    <input type="radio" name="question_{{questions.id}}" value="2" required>
                                    <span class="option-letter">B</span>
                                    <span class="option-text">{{ questions.op2 }}</span>
                                    <span class="checkmark"></span>
                                </label>
                                
                                <label class="option-card">
                                    <input type="radio" name="question_{{questions.id}}" value="3" required>
                                    <span class="option-letter">C</span>
                                    <span class="option-text">{{ questions.op3 }}</span>
                                    <span class="checkmark"></span>
                                </label>
                                
                                <label class="option-card">
                                    <input type="radio" name="question_{{questions.id}}" value="4" required>
                                    <span class="option-letter">D</span>
                                    <span class="option-text">{{ questions.op4 }}</span>
                                    <span class="checkmark"></span>
                                </label>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    
                    <div class="quiz-footer">
                        <div class="quiz-instructions">
                            <div class="instruction-icon">ℹ️</div>
                            <p>Select one answer per question. You can review and change answers before submitting.</p>
                        </div>
                        
                        <div class="action-buttons">
                            <button type="button" class="btn outline-btn" id="resetBtn">Reset Answers</button>
                            <button type="submit" class="btn primary-btn" id="submitBtn">
                                <span class="btn-text">Submit Quiz</span>
                                <span class="btn-icon">→</span>
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <script>
        // Mobile menu toggle
        const hamburger = document.getElementById('hamburger');
        const navMenu = document.getElementById('navMenu');
        
        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('active');
        });
        
        // Progress tracking
        const form = document.getElementById('quizForm');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const totalQuestions = {{ questions_data|length }};
        
        function updateProgress() {
            const answered = document.querySelectorAll('input[type="radio"]:checked').length;
            const percentage = (answered / totalQuestions) * 100;
                            
            progressBar.style.width = `${percentage}%`;
            progressText.textContent = `${answered}/${totalQuestions} answered`;
            
            if (answered === totalQuestions) {
                progressBar.classList.add('complete');
            } else {
                progressBar.classList.remove('complete');
            }
        }
        
        // Update progress when answers are selected
        form.addEventListener('change', updateProgress);
        
        // Initialize progress
        updateProgress();
        
        // Reset button functionality
        document.getElementById('resetBtn').addEventListener('click', () => {
            if (confirm('Are you sure you want to reset all your answers?')) {
                document.querySelectorAll('input[type="radio"]:checked').forEach(radio => {
                    radio.checked = false;
                });
                updateProgress();
            }
        });
        
    </script>
</body>
{% endblock %}